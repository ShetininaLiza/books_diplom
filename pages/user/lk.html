@using BisnessLogic.Models
@model IEnumerable<User>
<!--Стырила из своего диплома  WebApplication/Views/User/UpdateData.cshtml-->
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Личный кабинет</title>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
            <script>
                function printPas() {
                            var textPas;
                            textPas = document.getElementById("TextPass")
                            textPas.removeAttribute("type");
                            textPas.setAttribute("type", "text");
                        }

                 function SaveUpdateData() {
            Swal.fire({
                title: 'Вы точно хотите изменить данные?',
                showDenyButton: true,
                showCancelButton: false,
                confirmButtonText: 'Сохранить',
                denyButtonText: `Отмена`,
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    var login = document.getElementById("login").value;
                    if (login == '') {
                        Swal.fire("Поле \"Логин\" быть заполнены!")
                        return false;
                    }
                    var pas = document.getElementById("TextPass").value;
                    if (pas == '') {
                        Swal.fire("Поле \"Пароль\" быть заполнены!")
                        return false;
                    }
                    var phone = document.getElementById("Phone").value;
                    if (phone == '') {
                        Swal.fire("Поле \"Номер телефона\" быть заполнены!")
                        return false;
                    }
                var email = document.getElementById("Email").value;
                    if (email == '') {
                        Swal.fire("Поле \"Email\" быть заполнены!")
                        return false;
                    }
                    $.post("/User/UpdateData",
                        {
                            Login: login,
                            Pass: pas,
                            Last: ln,
                            First: name,
                            Otch: otch,
                            Work: work,
                            Tel: phone
                        },
                        function (data) {
                            Swal.fire('Изменения внесены успешно!', '', 'success');
                            location.reload();
                            //return true;
                            //$("form")
                        });
                    return true;
                }
                else if (result.isDenied) {
                    //Swal.fire('Changes are not saved', '', 'info')
                    location.reload();
                    return false;
                }
            });
        }
        function Censel() {
            Swal.fire({
                title: 'Вы точно хотите отменить изменение данные?\nВведенные данные не сохраняются.',
                showDenyButton: true,
                showCancelButton: false,
                confirmButtonText: 'Да',
                denyButtonText: `Нет`,
            }).then((result) => {
                if (result.isConfirmed) {
                    //Swal.fire('Changes are not saved', '', 'info')
                    location.reload();
                    return false;
                }

            });
        }

                function StartUpdate() {
            var texts;
            var buttons;
            texts = document.getElementsByTagName("input");
            for (var i = 0; i < texts.length; i++) {
                texts.item(i).removeAttribute("readonly");
            }
            buttons = document.getElementById("Buttons");
            var buttonSave = document.createElement("button");
            buttonSave.setAttribute("type", "submit");
            buttonSave.setAttribute("onclick", "SaveUpdateData();");
            buttonSave.setAttribute("name", "save");
            buttonSave.setAttribute("class", "btn btn-primary");
            buttonSave.innerHTML = "<label>Сохранить</label>";

            var buttonCen = document.createElement("button");
            buttonCen.setAttribute("type", "submit");
            buttonCen.setAttribute("onclick", "Censel();");
            buttonCen.setAttribute("class", "btn btn-primary");
            buttonCen.setAttribute("name", "cen");
            buttonCen.innerHTML = "<label>Отмена</label>";

            buttons.removeChild(document.getElementById("update"));
            buttons.appendChild(buttonSave);
            buttons.appendChild(buttonCen);
        }
            </script>
</head>
<body>
    <form id="form">
    <h1 align="center">Мои данные</h1>
        <div align="center">
         <p style="display:inline-block">
            <label>Логин: </label>
            <input id="login" type="text" required name="login" min="3" value="@user.Login" readonly />
        </p>
        <br />
        <p style="display:inline-block">
            <label>Пароль: </label>
            <input id="TextPass" type="password" required name="pass" value="@user.Password" readonly
                   pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^a-zA-Z0-9])\S{8,}"
                   title="Пароль должен содержать от 8 символов (английские строчные, заглавные, цифры и спец символы)" />
            <button class="btn btn-primary" onclick="printPas()">Отобразить</button>
        </p>
        <br />
    <p style="display:inline-block">
            <label>Номер телефона: </label>
            <input id="Phone" type="tel" required name="tel" value="@user.Phone" readonly 
                   pattern="89\d{9}" title="Формат телефона 89........." />
        </p>
<br />
<p style="display:inline-block">
            <label>Email: </label>
            <input id="Email" type="email" required name="email" value="@user.Email" readonly 
                   pattern="89\d{9}" title="Формат телефона 89........." />
        </p>
<br />
    <p id="Buttons" style="display:inline-block">
        <button id="update" class="btn btn-primary" style="text-align: center" onclick="StartUpdate()">Изменить данные</button>
    </p>
    </div>
    </form>
</body>
</html>
